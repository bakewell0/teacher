var vm=new Vue({el:"#app",data:{state:0,isMask:!1,records:[],coinName:"",coinsList:[],cash:100,option_one:-1,option_two:-1,option_three:-1,isChooseCoin:!1,searchContent:!1,exceed:!1},methods:{ch(t,e,s){"cur"==t.target.classList[1]?t.target.classList.remove("cur"):(t.target.classList.add("cur"),this.records.push({coin_id:e,coin_name:s,num:1}))},submitChoose(){this.isChooseCoin=!1,this.isMask=!1},getCoinsList(){axios.get(window.reqUrl+"/get/coins/namelist",{params:{name:this.searchFilter}}).then(t=>{0==t.data.error&&(this.coinsList=t.data.data),403==t.data.error&&(location.href="login.html")}).catch(function(t){console.log(t)})},cancelMask(){this.state=1},submit(){if(this.validate()){localStorage.getItem("token")||(location.href="login.html");var t=[];this.records.forEach(function(e){var s={coin_name:e.coin_name,weight:e.num/100,coin_id:e.coin_id};t.push(s)}),axios.post(window.reqUrl+"/add/portfolio",{portfolios:t,token:localStorage.getItem("token")}).then(function(t){0!=t.data.error?(alert(t.data.message),410==t.data.error&&(location.href="userCenter.html")):location.href="portfolios.html?folio_id="+t.data.data.folio_id}).catch(function(t){console.log(t)})}},submitQuestion(){var t={option_one:Number(this.option_one),option_two:Number(this.option_two),option_three:Number(this.option_three),token:localStorage.getItem("token")};axios.post(window.reqUrl+"/add/user/survey",t).then(function(t){alert(t.data.message)}).catch(function(t){console.log(t)})},validate(){var t=!0;return this.records.forEach(function(e,s){(e.num<0||e.num>100||!e.num)&&(alert("the weight you entered is wrong"),t=!1)}),t},changeNum(t){var e=0;this.records.forEach((t,s)=>{e+=Number(t.num)}),e<=100?(this.cash=100-e,this.exceed=!1):this.records[this.records.length-1].num=""},remove(t){this.cash=this.cash+Number(this.records[t].num),this.records.splice(t,1)},increase(t){this.records[t].num<100&&(this.records[t].num++,this.cash=this.cash-1)},decrease(t){this.records[t].num>0&&(this.records[t].num--,this.cash=this.cash+1)},checkCoin(t){var e=!0;return this.records.forEach(s=>{s.coin_id==t&&(e=!1)}),e},checkCash(){0==this.cash?this.exceed=!0:this.exceed=!1},addCoin(t,e){this.checkCash(),this.checkCoin(t)&&0!=this.cash&&(this.records.push({coin_name:e,coin_id:t,num:1}),this.cash=this.cash-1,this.searchContent=!1)},selectCoin(t){var e="";return this.coinsList.forEach(s=>{s.coin_name.toLowerCase()==t&&(e=s.coin_id)}),e},addBTC(){this.checkCash();var t=this.selectCoin("bitcoin");this.checkCoin(t)&&0!=this.cash&&(this.records.push({coin_id:t,coin_name:"Bitcoin",num:1}),this.cash=this.cash-1)},addETH(){this.checkCash();var t=this.selectCoin("ethereum");this.checkCoin(t)&&0!=this.cash&&(this.records.push({coin_id:t,coin_name:"Ethereum",num:1}),this.cash=this.cash-1)},addEOS(){this.checkCash();var t=this.selectCoin("eos");this.checkCoin(t)&&0!=this.cash&&(this.records.push({coin_id:t,coin_name:"EOS",num:1}),this.cash=this.cash-1)},addBANCA(){this.checkCash();var t=this.selectCoin("banca");this.checkCoin(t)&&0!=this.cash&&(this.records.push({coin_id:t,coin_name:"Banca",num:1}),this.cash=this.cash-1)},getSurveyState(){axios.get(window.reqUrl+"/get/user/survey/state",{params:{token:localStorage.getItem("token")}}).then(t=>{0==t.data.error?this.state=t.data.data.state:(alert(t.data.message),403==t.data.error&&(location.href="login.html"))}).catch(function(t){console.log(t)})},querySearch(t,e){var s=this.coinsList;e(s=t?s.filter(this.createFilter(t)):s)},createFilter:t=>e=>0===e.coin_name.toLowerCase().indexOf(t.toLowerCase())||0===e.simple_name.toLowerCase().indexOf(t.toLowerCase()),handleSelect(t){this.coinName=t.coin_name,this.addCoin(t.coin_id,t.coin_name)},handleIconClick(t){console.log(t)}},created(){this.getCoinsList()},watch:{records:{handler(t,e){t.forEach((t,e)=>{(t.num.toString().indexOf("-")>-1||t.num.toString().indexOf(".")>-1||Number(t.num)>100)&&(t.num="")})},deep:!0}}});
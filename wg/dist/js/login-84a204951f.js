var randomNum,vm=new Vue({el:"#app",data:{loginForm:{loginName:localStorage.getItem("loginName"),loginPassword:localStorage.getItem("loginPassword"),captchaCode:"",checked:localStorage.getItem("checked")},rules:{loginName:[{required:!0,message:"please enter your email address",trigger:"blur"},{type:"email",message:"please enter your correct email address",trigger:["blur","change"]}],loginPassword:[{required:!0,message:"please enter your password",trigger:"blur"}],captchaCode:[{required:!0,message:"please enter your captcha code",trigger:"blur"}]},reqUrl:"http://13.228.40.104:80/api-1.0.0/api/action.do",captchaImgUrl:""},methods:{submitForm(e){this.$refs[e].validate(e=>{e&&this.login()})},login(){axios.post(window.pcUrl,{actionCode:"login",loginName:this.loginForm.loginName,loginPassword:$.md5(this.loginForm.loginPassword),kaptchaNum:this.loginForm.captchaCode,kaptchaRandomNum:randomNum}).then(e=>{0==e.data.meta.errno?(localStorage.setItem("token",e.data.result.data.token),localStorage.setItem("type",e.data.result.data.type),localStorage.setItem("logoUrl",e.data.result.data.logoUrl),localStorage.setItem("referName",e.data.result.data.referName),localStorage.setItem("referId",e.data.result.data.referId),localStorage.setItem("loginName",e.data.result.data.loginName),location.href="index.html"):($("#captcha").trigger("click"),alert(e.data.meta.msg))}).catch(function(e){console.log(e)})},ck(){this.loginForm.checked?(localStorage.removeItem("loginName"),localStorage.removeItem("loginPassword"),localStorage.removeItem("checked")):(localStorage.setItem("loginName",this.loginForm.loginName),localStorage.setItem("loginPassword",this.loginForm.loginPassword),localStorage.setItem("checked",!this.loginForm.checked))},send(){axios.post(window.pcUrl,{actionCode:"sendActivateMail",token:localStorage.getItem("token")}).then(function(e){alert(e.data.meta.msg),location.href="index.html"}).catch(function(e){console.log(e)})},getCaptchaImage(){randomNum=Math.floor(1e4*Math.random()).toString(),axios.post(window.captchaUrl,{random:randomNum}).then(e=>{this.captchaImgUrl="data:image/jpeg;base64,"+e.data.result.data.img}).catch(function(e){console.log(e)})}},created:function(){this.getCaptchaImage()}});